#N canvas 452 22 779 737 10;
#X obj 207 245 d--;
#X obj 207 264 + 31;
#X msg 251 198 stop;
#X obj 40 4 inlet;
#X text 562 540 do nothing;
#X text 577 635 move cur-1 to cur;
#X text 548 716 stop;
#X text 258 451 timetag found?;
#X text 184 470 no;
#X text 260 472 yes;
#X obj 375 330 f;
#X text 400 332 x;
#X obj 360 453 >;
#X text 387 452 cur>x?;
#X obj 207 392 t a a;
#X text 222 503 cur>x?;
#X text 372 503 cur>x?;
#X text 26 533 no - 2;
#X text 197 531 yes - 1;
#X text 299 525 no - 4;
#X text 413 530 yes - 3;
#X text 190 338 current array pos;
#X obj 48 587 f;
#X obj 136 642 f;
#X obj 21 560 t b b;
#X obj 437 549 - 1;
#X obj 401 573 f;
#X msg 401 549 bang;
#X obj 207 226 d-for 0 32;
#X obj 194 599 t a a;
#X text 51 601 swap store and cur;
#X text 558 575 swap store and cur;
#X obj 165 642 f;
#X obj 81 587 f;
#X obj 430 330 f;
#X text 456 331 timetag;
#X obj 309 543 t b;
#X obj 430 308 f 0;
#X obj 461 308 + 1;
#X obj 491 308 % 32;
#X msg 430 281 bang;
#X obj 207 319 t a a a;
#X obj 439 408 sel 0;
#X msg 261 428 1;
#X msg 233 428 0;
#X text 192 545 (do nothing);
#X obj 40 484 t b b;
#X msg 67 514 0;
#X text 549 622 if cur-1>x;
#X obj 448 698 f;
#X obj 401 636 moses;
#X msg 448 678 bang;
#X obj 354 699 f;
#X obj 379 699 f;
#X msg 354 677 bang;
#X text 527 503 (init) put x \, tt -> store;
#X obj 40 294 outlet;
#X obj 40 71 route insert clear get size;
#X obj 169 171 - 1;
#X msg 194 171 end \$1;
#X obj 405 39 table \$0-values 32;
#X obj 543 39 table \$0-timetags 32;
#N canvas 0 22 450 300 tw 0;
#X obj 25 18 inlet;
#X obj 82 20 inlet;
#X obj 269 20 inlet;
#X obj 100 107 tabwrite \$0-timetags;
#X obj 26 72 tabwrite \$0-values;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 2 0 4 1;
#X restore 354 720 pd tw;
#N canvas 0 22 450 300 tw 0;
#X obj 25 18 inlet;
#X obj 82 20 inlet;
#X obj 269 20 inlet;
#X obj 100 107 tabwrite \$0-timetags;
#X obj 26 72 tabwrite \$0-values;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 2 0 4 1;
#X restore 435 721 pd tw;
#N canvas 0 22 450 300 tw 0;
#X obj 25 18 inlet;
#X obj 82 20 inlet;
#X obj 269 20 inlet;
#X obj 100 107 tabwrite \$0-timetags;
#X obj 26 72 tabwrite \$0-values;
#X connect 0 0 4 0;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 2 0 4 1;
#X restore 48 620 pd tw;
#N canvas 0 22 450 300 tr 0;
#X obj 29 176 outlet;
#X obj 95 176 outlet;
#X obj 29 11 inlet;
#X obj 29 39 t a a;
#X obj 29 79 tabread \$0-values;
#X obj 95 112 tabread \$0-timetags;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 3 1 5 0;
#X connect 4 0 0 0;
#X connect 5 0 1 0;
#X restore 152 620 pd tr;
#N canvas 0 22 450 300 tr 0;
#X obj 29 176 outlet;
#X obj 95 176 outlet;
#X obj 29 11 inlet;
#X obj 29 39 t a a;
#X obj 29 79 tabread \$0-values;
#X obj 96 112 tabread \$0-timetags;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 3 1 5 0;
#X connect 4 0 0 0;
#X connect 5 0 1 0;
#X restore 401 600 pd tr;
#X obj 207 363 tabread \$0-values;
#X obj 439 375 tabread \$0-timetags;
#X obj 34 411 s \$0-values;
#X msg 93 390 resize \$1;
#X obj 76 354 t b a;
#X obj 43 437 s \$0-timetags;
#X msg 34 389 const 0;
#X obj 207 292 sel 0;
#X obj 40 189 t b b;
#X msg 184 39 size \$1;
#X text 544 648 else;
#X text 574 657 put x \, tt at cur;
#X text 574 669 stop;
#X text 381 13 implements a running median in two arrays:;
#X text 376 93 on insert \, we find the value with the current timetag
;
#X text 376 103 and remove it \, and insert the new value with the
current;
#X text 376 147 the array \, stepping backwards.;
#X text 548 703 put store at cur (same as 2.);
#X text 51 338 clear on resize;
#X text 465 389 timetag found?;
#X text 452 478 (x is value \, tt is timetag);
#X text 226 695 part of dlib;
#X text 15 761 released under the GNU General Public License v3+;
#X text 133 722 copyright damian stewart 2008;
#X text 104 736 damian@frey.co.nz | www.frey.co.nz;
#X text 136 658 .. other part of 'store';
#X text 52 574 part of 'store'..;
#X text 376 137 this implemention does both steps in a single pass
through;
#X text 376 67 one array stores values \, the other stores timetags.
;
#X text 239 263 step backwards;
#X text 194 279 if we reach the start - bail out;
#X text 4 498 force write at pos 0;
#X text 449 466 when inserting x \, tt there are 4 possibilities:;
#X text 525 528 1 timetag not yet found \, cur>x;
#X text 525 561 2 timetag not yet found \, cur<x;
#X text 524 607 3 timetag found \, cur>x;
#X text 524 691 4 timetag found \, cur<x;
#X text 391 618 is cur-1>x ?;
#X text 437 652 yes;
#X text 379 652 no;
#X obj 184 18 d-default \$1 32;
#X text 376 115 timetag so as to maintain order in the values table.
;
#X obj 207 453 d-gate2;
#X obj 169 503 d-gate2;
#X obj 319 503 d-gate2;
#X obj 40 166 t b a b;
#X obj 40 109 t a a;
#X obj 67 134 s \$0-inserted;
#X obj 178 112 s \$0-size;
#N canvas 711 55 460 416 get-median 0;
#X obj 223 109 f 0;
#X obj 253 109 + 1;
#X obj 280 110 moses 32;
#X msg 238 89 0;
#X obj 280 130 + 1;
#X obj 280 150 / 2;
#X obj 281 174 pack f f;
#X msg 281 194 \$2 \$1;
#X obj 281 215 -;
#X obj 54 364 outlet;
#X obj 270 34 r \$0-size;
#X obj 163 34 r \$0-inserted;
#X msg 163 63 bang;
#X obj 54 37 inlet;
#X obj 54 278 16;
#X obj 54 329 tabread \$0-values;
#X text 61 312 return median;
#X obj 54 299 int;
#X msg 54 101 bang;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 0 1;
#X connect 2 0 4 0;
#X connect 3 0 0 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 14 1;
#X connect 10 0 3 0;
#X connect 10 0 2 1;
#X connect 10 0 6 1;
#X connect 11 0 12 0;
#X connect 12 0 0 0;
#X connect 13 0 18 0;
#X connect 14 0 17 0;
#X connect 15 0 9 0;
#X connect 17 0 15 0;
#X connect 18 0 14 0;
#X restore 40 268 pd get-median;
#X connect 0 0 1 0;
#X connect 1 0 74 0;
#X connect 2 0 28 0;
#X connect 3 0 57 0;
#X connect 10 0 12 1;
#X connect 10 0 22 1;
#X connect 10 0 50 1;
#X connect 10 0 52 1;
#X connect 12 0 110 1;
#X connect 12 0 111 1;
#X connect 14 0 109 0;
#X connect 14 1 12 0;
#X connect 22 0 64 0;
#X connect 23 0 22 1;
#X connect 24 0 23 0;
#X connect 24 0 32 0;
#X connect 24 1 22 0;
#X connect 24 1 33 0;
#X connect 25 0 26 1;
#X connect 26 0 66 0;
#X connect 27 0 26 0;
#X connect 28 0 0 0;
#X connect 29 0 65 0;
#X connect 32 0 33 1;
#X connect 33 0 64 1;
#X connect 34 0 33 1;
#X connect 34 0 42 1;
#X connect 34 0 53 1;
#X connect 36 0 24 0;
#X connect 36 0 2 0;
#X connect 37 0 38 0;
#X connect 37 0 34 0;
#X connect 38 0 39 0;
#X connect 39 0 37 1;
#X connect 40 0 37 0;
#X connect 41 0 67 0;
#X connect 41 1 25 0;
#X connect 41 1 29 0;
#X connect 41 1 62 2;
#X connect 41 1 63 2;
#X connect 41 1 64 2;
#X connect 41 2 68 0;
#X connect 42 0 43 0;
#X connect 43 0 109 1;
#X connect 44 0 109 1;
#X connect 46 0 24 0;
#X connect 46 1 47 0;
#X connect 47 0 64 2;
#X connect 49 0 63 1;
#X connect 50 0 54 0;
#X connect 50 1 51 0;
#X connect 50 1 63 0;
#X connect 51 0 49 0;
#X connect 52 0 62 0;
#X connect 53 0 62 1;
#X connect 54 0 52 0;
#X connect 54 0 53 0;
#X connect 54 0 2 0;
#X connect 57 0 113 0;
#X connect 57 1 73 0;
#X connect 57 3 39 1;
#X connect 57 3 71 0;
#X connect 57 3 58 0;
#X connect 57 3 59 0;
#X connect 57 3 115 0;
#X connect 57 4 113 0;
#X connect 58 0 1 1;
#X connect 59 0 28 0;
#X connect 65 0 23 1;
#X connect 65 1 32 1;
#X connect 66 0 50 0;
#X connect 66 1 49 1;
#X connect 67 0 14 0;
#X connect 68 0 42 0;
#X connect 70 0 69 0;
#X connect 70 0 72 0;
#X connect 71 0 73 0;
#X connect 71 1 70 0;
#X connect 73 0 69 0;
#X connect 73 0 72 0;
#X connect 74 0 46 0;
#X connect 74 1 41 0;
#X connect 75 0 116 0;
#X connect 75 1 28 0;
#X connect 76 0 57 0;
#X connect 107 0 76 0;
#X connect 109 0 110 0;
#X connect 109 1 111 0;
#X connect 110 0 24 0;
#X connect 111 0 36 0;
#X connect 111 1 27 0;
#X connect 112 0 75 0;
#X connect 112 1 10 0;
#X connect 112 1 40 0;
#X connect 112 1 44 0;
#X connect 113 0 112 0;
#X connect 113 1 114 0;
#X connect 116 0 56 0;
